<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Management Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="/js/dashboard.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .animate-slide-in {
            animation: slideIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .hover-scale {
            transition: transform 0.3s ease;
        }

        .hover-scale:hover {
            transform: scale(1.05);
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #1F2937;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: #4B5563;
            border-radius: 20px;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
    <div class="flex h-screen">
        <button id="sidebar-toggle" class="fixed top-11 left-12 p-2  bg-gray-800 text-white rounded-full z-30 hover:bg-gray-700 dark:bg-gray-600 dark:hover:bg-gray-500 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
            <span class="sr-only">Toggle sidebar</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
          
          <!-- Sidebar Overlay -->
          <div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-50 hidden z-20 transition-opacity duration-300 ease-in-out opacity-0"></div>
          
          <!-- Sidebar Structure -->
          <aside id="sidebar" class="fixed top-0 left-0 h-full w-72 transform -translate-x-full bg-white dark:bg-gray-800 shadow-lg transition-all duration-300  z-30 overflow-hidden">
            <div class="sidebar-content h-full flex flex-col">
              
              <!-- Header -->
              <header class="p-4 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600">
                <div class="flex items-center justify-between">
                  <h2 class="text-xl font-bold text-gray-800 dark:text-white">Dashboard</h2>
                  <button id="sidebar-close" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-white focus:outline-none">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                  </button>
                </div>
              </header>
              
              <!-- User Profile Section -->
              <div class="p-4 bg-gray-100 dark:bg-gray-750 border-b border-gray-200 dark:border-gray-600">
                <div class="flex items-center space-x-3">
                  <img src="<%= user ? user.picture : 'https://cdn-icons-png.flaticon.com/512/149/149071.png' %>" alt="User Avatar" class="w-12 h-12 rounded-full border-2 border-blue-500">
                  <div>
                    <p class="font-semibold text-gray-800 dark:text-gray-900"><%= user.username %></p>
                    <p class="text-sm text-gray-600 dark:text-gray-900"><%= user.id %></p>
                  </div>
                </div>
                <div class="mt-3">
                  <a href="/dashboard" class="text-sm text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300">View Profile</a>
                </div>
              </div>
              
              <!-- Search Bar -->
              <div class="p-4 border-b border-gray-200 dark:border-gray-600">
                <div class="relative">
                  <input type="text" id="sidebar-search" placeholder="Search..." class="w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 absolute left-3 top-2.5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                  </svg>
                </div>
                <div id="search-results" class="mt-2 hidden">
                  <ul class="bg-white dark:bg-gray-700 rounded-lg shadow-md"></ul>
                </div>
              </div>
              
              <!-- Sidebar Menu -->
              <nav class="flex-1 overflow-y-auto py-4">
                <ul id="sidebar-menu" class="space-y-2 px-3">
                  <li>
                    <a href="/dashboard" class="menu-item flex items-center p-3 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                      </svg>
                      Home
                    </a>
                  </li>
                  <li>
                    <a href="/dashboard/user/tasks" class="menu-item group flex items-center p-3 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-gray-500 group-hover:text-blue-500 transition-colors duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                      </svg>
                      Tasks
                    </a>
                  </li>
                  <li>
                    <a href="/dashboard/user/reports" class="menu-item group flex items-center p-3 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-gray-500 group-hover:text-blue-500 transition-colors duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                      </svg>
                      Reports
                    </a>
                  </li>
                  <li>
                    <a href="/dashboard/user/meetings" class="menu-item group flex items-center p-3 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-gray-500 group-hover:text-blue-500 transition-colors duration-200" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                      </svg>
                      Meetings
                    </a>
                  </li>
                </ul>
              </nav>
              
              <!-- Footer -->
              <footer class="p-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600">
                <div class="flex items-center justify-between">
                  <a href="/logout" class="flex items-center text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    Logout
                  </a>
                  <button id="theme-toggle" class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5">
                    <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                    </svg>
                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path>
                    </svg>
                  </button>
                </div>
              </footer>
            </div>
          </aside>
          
          <script>
            document.addEventListener('DOMContentLoaded', () => {
              const sidebar = document.getElementById('sidebar');
              const sidebarMenu = document.getElementById("sidebar-menu");
              const overlay = document.getElementById('sidebarOverlay');
              const sidebarToggle = document.getElementById('sidebar-toggle');
              const sidebarClose = document.getElementById('sidebar-close');
              const themeToggle = document.getElementById('theme-toggle');
              const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
              const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
              const body = document.body;
              const searchInput = document.getElementById('sidebar-search');
              const searchResults = document.getElementById('search-results');
          
              function toggleSidebar() {
                sidebar.classList.toggle('-translate-x-full');
                overlay.classList.toggle('hidden');
                overlay.classList.toggle('opacity-0');
              }
          
              sidebarToggle.addEventListener('click', toggleSidebar);
              sidebarClose.addEventListener('click', toggleSidebar);
              overlay.addEventListener('click', toggleSidebar);
          
              // Close sidebar when clicking outside
              document.addEventListener('click', (e) => {
                if (!sidebar.contains(e.target) && !sidebarToggle.contains(e.target) &&
                    !sidebar.classList.contains('-translate-x-full')) {
                  toggleSidebar();
                }
              });
          
              function setTheme(isDark) {
                if (isDark) {
                  body.classList.add('dark');
                  themeToggleLightIcon.classList.remove('hidden');
                  themeToggleDarkIcon.classList.add('hidden');
                  localStorage.setItem('color-theme', 'dark');
                } else {
                  body.classList.remove('dark');
                  themeToggleLightIcon.classList.add('hidden');
                  themeToggleDarkIcon.classList.remove('hidden');
                  localStorage.setItem('color-theme', 'light');
                }
              }
          
              const savedTheme = localStorage.getItem('color-theme');
              const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
              
              if (savedTheme === 'dark' || (savedTheme === null && systemTheme)) {
                setTheme(true);
              } else {
                setTheme(false);
              }
          
              themeToggle.addEventListener('click', () => {
                const isDark = !body.classList.contains('dark');
                setTheme(isDark);
              });
          
              searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                if (searchTerm.length > 2) {
                  const results = [
                    { title: 'Dashboard', url: '/dashboard' },
                    { title: 'Tasks', url: '/dashboard/user/tasks' },
                    { title: 'Reports', url: '/dashboard/user/reports' },
                    { title: 'Meetings', url: '/dashboard/user/meetings' }
                  ].filter(item => item.title.toLowerCase().includes(searchTerm));
          
                  const resultsHtml = results.map(result => `
                    <li>
                      <a href="${result.url}" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200">
                        ${result.title}
                      </a>
                    </li>
                  `).join('');
          
                  searchResults.querySelector('ul').innerHTML = resultsHtml;
                  searchResults.classList.remove('hidden');
                } else {
                  searchResults.classList.add('hidden');
                }
              });
          
              document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                  searchResults.classList.add('hidden');
                }
              });
            });
          </script>
          
          <style>
            @layer components {
              .sidebar-content {
                @apply scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600 scrollbar-track-transparent;
              }
          
              .menu-item {
                @apply transition-all duration-200 hover:bg-gray-100 dark:hover:bg-gray-700;
              }
          
              .menu-item svg {
                @apply transition-colors duration-200;
              }
          
              .menu-item:hover svg {
                @apply text-blue-500;
              }
          
              .menu-item.active {
                @apply bg-blue-50 dark:bg-blue-900;
              }
          
              .menu-item.active svg {
                @apply text-blue-500;
              }
            }
          
            @keyframes fadeIn {
              from { opacity: 0; }
              to { opacity: 1; }
            }
          
            @keyframes slideIn {
              from { transform: translateX(-100%); }
              to { transform: translateX(0); }
            }
          
            #sidebar {
              animation: slideIn 0.3s ease-out;
            }
          
            #sidebarOverlay {
              animation: fadeIn 0.3s ease-out;
            }
          </style>

        <!-- Main Content -->
        <main class="flex-1 p-4 md:p-8 overflow-y-auto h-screen">
            <header class="mb-8 animate-fade-in sticky">
                <div class="flex flex-col md:flex-row bg-slate-700 p-4  justify-center align-middle items-center rounded-lg shadow animate-pulse">
                    <h1 class="text-3xl font-bold text-white mr-[700px]">Management Dashboard</h1>
                    <div class="flex justify-end  items-end space-x-4 ">
                        <button id="notificationBtn" class=" p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors relative hover-scale">
                            <i class="ri-notification-3-line text-gray-300"></i>
                            <span id="notificationBadge" class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500 animate-pulse hidden"></span>
                        </button>
                        <div class="relative">
                            <button id="userMenuBtn" class="p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors hover-scale">
                                <img src="<%= user.picture || 'https://cdn-icons-png.flaticon.com/512/149/149071.png' %>" alt="User" class="rounded-full w-8 h-8">
                            </button>
                            <div id="userMenu" class="absolute right-0 mt-2 w-48 bg-gray-800 rounded-md shadow-lg py-1 hidden">
                                <a href="/dashboard" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700">
                                    <i class="ri-user-line mr-2"></i>Profile
                                </a>
                                <a href="/dashboard" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700">
                                    <i class="ri-settings-3-line mr-2"></i>Settings
                                </a>
                                <a href="/logout" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700">
                                    <i class="ri-logout-box-r-line mr-2"></i>Logout
                                </a>
                            </div>
                        </div>
                        <button id="darkModeToggle" class="p-2 rounded-full bg-gray-800 hover:bg-gray-700 transition-colors hover-scale">
                            <i class="ri-sun-line text-gray-300"></i>
                        </button>
                    </div>
                </div>
            </header>

            <div class="grid gap-8 md:grid-cols-3 lg:grid-cols-2 mb-8">
                <div class="bg-gray-800 rounded-lg p-6 shadow-lg animate-slide-in hover-scale">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="ri-task-line mr-2 text-blue-500"></i>
                        User Overview
                    </h2>
                    <div class="space-y-4">
                        <p><i class="ri-clipboard-line mr-2 text-green-500"></i>Todo Tasks: <%= tasks.todo.length %></p>
                        <p><i class="ri-file-list-3-line mr-2 text-yellow-500"></i>Reports: <%= reports.length %></p>
                        <p><i class="ri-team-line mr-2 text-purple-500"></i>Meetings: <%= meeting.meetings.length %></p>
                    </div>
                </div>

                <div id="quickActions" class="bg-gray-800 rounded-lg p-6 shadow-lg animate-slide-in hover-scale">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="ri-flashlight-line mr-2 text-yellow-500"></i>
                        Quick Actions
                    </h2>
                    <div class="grid grid-cols-2 gap-4">
                        <button id="add_report_btn" class="p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-500 hover-scale">
                            <i class="ri-file-add-line mr-2"></i>
                            <span>Create Report</span>
                        </button>
                        <button id="scheduleMeetingBtn" class="p-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-green-500 hover-scale">
                            <i class="ri-calendar-event-line mr-2"></i>
                            <span>Schedule Meeting</span>
                        </button>
                        <button id="add_feedback_btn" class="p-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-yellow-500 hover-scale">
                            <i class="ri-message-2-line mr-2"></i>
                            <span>Send Feedback</span>
                        </button>
                        <button id="add-task-btn" class="p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-500 hover-scale"> 
                            <i class="ri-task-line mr-2"></i>Add Task
                        </button>
                    </div>
                </div>
            </div>

            <div id="tasks-column" class="grid gap-8 md:grid-cols-3 mb-8">
                <div id="todoColumn" class="bg-gray-800 rounded-lg p-6 shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="ri-checkbox-multiple-line mr-2 text-blue-500"></i>To Do
                    </h3>
                    <p class="text-sm mb-4 text-gray-400">You can add up to 5 tasks and u currently can add <%= 5 - tasks.todo.length - tasks.pending.length - tasks.done.length %> More Tasks.
                    <strong>For More Details Click on <a href="/dashboard/user/tasks" class="text-blue-500 hover:underline">Task</a></strong></p>
                    <div class="space-y-4 max-h-96 overflow-y-auto custom-scrollbar" id="todoTasks">
                        <% tasks.todo.forEach((task, index) => { %>
                            <% if (index < 2) { %>
                                <div class="task_div bg-gray-700 rounded-lg p-4">
                                    <div class="flex justify-between items-center">
                                        <p class="font-medium">
                                            <% if (task.priority === 'high') { %>
                                                <i class="ri-error-warning-line text-red-500 mr-2"></i>
                                            <% } else if (task.priority === 'medium') { %>
                                                <i class="ri-error-warning-line text-yellow-500 mr-2"></i>
                                            <% } else { %>
                                                <i class="ri-error-warning-line text-green-500 mr-2"></i>
                                            <% } %>
                                            <span class="todo_task_name"><%= task.task_name %></span>
                                        </p>
                                        <div class="flex space-x-2">
                                            <button id="status-pending-btn"  class=" text-blue-400 hover:text-blue-300 transition duration-150" data-task-id="<%= task.task_id %>">
                                                <i class="ri-time-line"></i>
                                            </button>
                                            <button id="status-done-btn" class=" text-green-400 hover:text-green-300 transition duration-150" data-task-id="<%= task.task_id %>">
                                                <i class="ri-checkbox-circle-line"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <p class="text-sm text-gray-400 mt-2">Due Date: <%= task.due_date %></p>
                                </div>
                            <% } %>
                        <% }) %>
                    </div>
                    <% if (tasks.todo.length > 2) { %>
                        <button id="showMoreTodo" class="mt-4 w-full bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition duration-150 hover-scale">
                            <a href="/dashboard/user/tasks">Show More</a>
                        </button>
                    <% } %>
                    <button id="add-task-btn" class="mt-4 w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-150 hover-scale">
                        <i class="ri-add-line mr-2"></i>Add Task
                    </button>
                </div>

                <div id="inProgressColumn" class="bg-gray-800 rounded-lg p-6 shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="ri-loader-4-line mr-2 text-yellow-500"></i>In Progress
                    </h3>
                    <div class="space-y-4 max-h-96 overflow-y-auto custom-scrollbar" id="inProgressTasks">
                        <% tasks.pending.forEach((task, index) => { %>
                            <% if (index < 2) { %>
                                <div class="task_div bg-gray-700 rounded-lg p-4">
                                    <div class="flex justify-between items-center">
                                        <p class="font-medium"><%= task.task_name %></p>
                                        <button id="status-done-btn" class=" text-green-400 hover:text-green-300 transition duration-150" data-task-id="<%= task.task_id %>">
                                            <i class="ri-checkbox-circle-line"></i>
                                        </button>
                                    </div>
                                </div>
                            <% } %>
                        <% }) %>
                    </div>
                    <% if (tasks.pending.length > 2) { %>
                        <button id="showMoreInProgress" class="mt-4 w-full bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition duration-150 hover-scale">
                            <a href="/dashboard/user/tasks">Show More</a>
                        </button>
                    <% } %>
                </div>

                <div id="doneColumn" class="bg-gray-800 rounded-lg p-6 shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="ri-checkbox-multiple-fill mr-2 text-green-500"></i>Done
                    </h3>
                    <p class="text-sm mb-4 text-gray-400">Tasks will be deleted in 1hr automatically</p>
                    <div class="space-y-4 max-h-96 overflow-y-auto custom-scrollbar" id="doneTasks">
                        <% tasks.done.forEach((task, index) => { %>
                            <% if (index < 2) { %>
                                <div class="done_div bg-gray-700 rounded-lg p-4 hover-scale">
                                    <div class="flex justify-between items-center">
                                        <p class="font-medium"><%= task.task_name %></p>
                                        <button id="delete-task-btn" class="delete-task-btn text-red-400 hover:text-red-300 transition duration-150" data-task-id="<%= task.task_id %>">
                                            <i class="ri-delete-bin-line"></i>
                                        </button>
                                    </div>
                                </div>
                            <% } %>
                        <% }) %>
                    </div>
                    <% if (tasks.done.length > 2) { %>
                        <button id="showMoreDone" class="mt-4 w-full bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition duration-150 hover-scale">
                            <a href="/dashboard/user/tasks">Show More</a>
                        </button>
                    <% } %>
                </div>
            </div>

            <div id="reports-and-meetings" class="grid gap-8 md:grid-cols-3">
                <div class="bg-gray-800 rounded-lg p-6 shadow-lg animate-slide-in">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="ri-file-text-line mr-2 text-blue-500"></i>
                        Reports
                    </h2>
                    <p class="text-sm mb-4 text-gray-400">View and manage your reports <strong>For More details click <a href="/dashboard/user/reports" class="text-blue-500 hover:underline">REPORTS </a></strong></p>
                    <div class="space-y-4 max-h-96 overflow-y-auto custom-scrollbar" id="reportsList">
                        <% reports.forEach((report, index) => { %>
                            <% if (index < 2) { %>
                                <div class="report-item bg-gray-700 rounded-lg p-4">
                                    <button class="report-dropdown flex justify-between items-center w-full">
                                        <span class="flex items-center">
                                            <i class="ri-file-text-line mr-2 text-blue-500"></i>
                                            <%= report.report_title %>
                                        </span>
                                        <i class="ri-arrow-down-s-line"></i>
                                    </button>
<div class="report-dropdown-menu hidden bg-gray-800 rounded-lg p-4 mt-2 shadow-lg animate-slide-in w-full ">
    <ul class="space-y-2">
        <li>
            <a href="/dashboard/user/report" class="flex items-center hover:bg-gray-700 p-2 rounded-lg hover-scale">
                <i class="ri-file-text-line mr-2 text-blue-500"></i>
                View Report
            </a>
        </li>
        <li>
            <button id="update_report" data-report-id="<%= report.report_id %>" class="flex items-center hover:bg-gray-700 p-2 rounded-lg hover-scale">
                <i class="ri-edit-line mr-2 text-yellow-500"></i>
                Edit Report
            </button>
        </li>
        <li>
         <button id="delete_report_btn" data-report-id="<%= report.report_id %>" class="flex items-center hover:bg-gray-700 p-2 rounded-lg hover-scale">
                <i class="ri-delete-bin-line mr-2 text-red-500"></i>
                Delete Report
            </button>
        </li>
    </ul>

</div>
                                </div>
                            <% } %>
                        <% }) %>
                    </div>
                    <% if (reports.length > 2) { %>
                        <button id="showMoreReports" class="mt-4 w-full bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition duration-150 hover-scale">
                            <a href="/dashboard/user/reports">Show More</a>
                        </button>
                    <% } %>
                    <button id="add_report_btn" class="mt-4 w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <i class="ri-add-line mr-2"></i>Create New Report
                    </button>
                </div>

                <div class="bg-gray-800 rounded-lg p-6 shadow-lg animate-slide-in">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="ri-calendar-event-line mr-2 text-green-500"></i>
                        Meetings
                    </h2>
                    
                    <p class="text-sm mb-4 text-gray-400">Schedule and manage your meetings</p>
                    <p>For more options visit <a href="/dashboard/user/meetings" class="text-blue-500 hover:underline">Meetings</a></p>
                    <div class="space-y-4 max-h-96 overflow-y-auto custom-scrollbar" id="meetingsList">
                        <% meeting.meetings.forEach((meeting,index ) => { %>
                            <% if (index < 2) { %>
                                <div class="meeting_div bg-gray-700 rounded-lg p-4">
                                    <h3 class="font-semibold"><%= meeting.title %></h3>
                                    <p class="text-sm text-gray-400 mt-2">
                                        <i class="ri-time-line mr-1"></i>
                                        <%= meeting.date %> at <%= meeting.time %>
                                    </p>
                                </div>
                            <% } %>
                        <% }) %>
                    </div>
                    <% if (meeting.meetings.length > 2) { %>
                        <button id="showMoreMeetings" class="mt-4 w-full bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition duration-150 hover-scale">
                            <a href="/dashboard/user/meetings">Show More</a>
                        </button>
                    <% } %>
                    <button id="scheduleMeetingBtn" class="mt-4 w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors focus:outline-none focus:ring-2 focus:ring-green-500">
                        <i class="ri-add-line mr-2"></i>Schedule New Meeting
                    </button>
                </div>
            </div>
        </main>
    </div>
<%-include('partials/forms.ejs')%>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/intro.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const darkModeToggle = document.getElementById('darkModeToggle');
            const html = document.documentElement;
            const icon = darkModeToggle.querySelector('i');

            function setDarkMode(isDark) {
                if (isDark) {
                    html.classList.add('dark');
                    icon.classList.remove('ri-sun-line');
                    icon.classList.add('ri-moon-line');
                    localStorage.setItem('darkMode', 'true');
                } else {
                    html.classList.remove('dark');
                    icon.classList.remove('ri-moon-line');
                    icon.classList.add('ri-sun-line');
                    localStorage.setItem('darkMode', 'false');
                }
            }

            setDarkMode(true);

            darkModeToggle.addEventListener('click', () => {
                const isDark = html.classList.toggle('dark');
                setDarkMode(isDark);
            });



            document.querySelectorAll('.report-dropdown').forEach(dropdown => {
                dropdown.addEventListener('click', () => {
                    const content = dropdown.nextElementSibling;
                    content.classList.toggle('hidden');
                });
            });

            function showMoreItems(listId, btnId) {
                const list = document.getElementById(listId);
                const btn = document.getElementById(btnId);
                const items = list.querySelectorAll('.task_div, .report-item, .meeting_div');
                
                items.forEach((item, index) => {
                    if (index >= 2) {
                        item.classList.toggle('hidden');
                    }
                });

            }

const report_dropdown = document.querySelectorAll('.report-dropdown');
report_dropdown.forEach(dropdown => {
    dropdown.addEventListener('click', () => {
        const content = dropdown.nextElementSibling;
        content.classList.toggle('hidden');
    });
});

            document.getElementById('showMoreTodo')?.addEventListener('click', () => showMoreItems('todoTasks', 'showMoreTodo'));
            document.getElementById('showMoreInProgress')?.addEventListener('click', () => showMoreItems('inProgressTasks', 'showMoreInProgress'));
            document.getElementById('showMoreDone')?.addEventListener('click', () => showMoreItems('doneTasks', 'showMoreDone'));
            document.getElementById('showMoreReports')?.addEventListener('click', () => showMoreItems('reportsList', 'showMoreReports'));
            document.getElementById('showMoreMeetings')?.addEventListener('click', () => showMoreItems('meetingsList', 'showMoreMeetings'));
        });
    //     introJs().setOptions({
    //     steps : [
    //         {
    //             title : "Welcome to Task Manager Your ultimate project management tool",
    //             intro : "You can create tasks, reports, meetings and more with Task Manager. Get started by clicking the buttons below",
    //         } , 
    //         {
    //             element : document.getElementById("notificationBtn"),
    //             title : "Notifications",
    //             intro : "You can view your notifications here",
    //         }, { 
    //             element : document.getElementById("userMenuBtn"),
    //             title : "User Menu",
    //             intro : "Click here to view your profile",
    //         } , { 
    //             element : document.getElementById("quickActions"),
    //             title : "Quick Actions",
    //             intro : "You can add tasks, reports, meetings and more with quick actions",
    //         }
    //         , { 
    //             element : document.getElementById("tasks-column"),
    //             title : "Tasks",
    //             intro : "You can view your tasks here and mark them as done or undone and more " ,
    //         }
    //         ,
    //         {
    //             element: document.getElementById("reports-and-meetings"),
    //             title: "Reports and Meetings",
    //             intro: 'You can view your reports and meetings here and more',
    //         },
           
    //     ],
       
    //     showBullets : true,
    //     showButtons : true,
    //     exitOnEsc : true,
    //     exitOnOverlayClick : false,
    //     dontShowAgain : true,
    //     showStepNumbers : true,
    //     showProgress : true,
    //     disableInteraction : true,
    //     nextToDone : true,
        
    // }).start();

    </script>
</body>
</html>