<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Management Dashboard</title>
    <link rel="stylesheet" href="/css/tailwind.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/dashboard.css">
    <script src="https://kit.fontawesome.com/60cc3418d0.js" crossorigin="anonymous"></script>
    <script src="/js/dashboard.js"></script>
    <style>
        
    </style>
</head>
<body class="min-h-screen transition-colors duration-300">
    <div class="content p-4 max-w-7xl mx-auto md:ml-[100px]">        <div class="mb-4 animate-fadeIn box rounded-lg shadow-md p-4 transition-all duration-300">
            <div class="flex items-center justify-between">
                <h1 class="text-xl sm:text-2xl font-bold">Management Dashboard</h1>
                <div class="flex items-center space-x-2">
                    <button id="notificationBtn" class="p-2 rounded-full hover:bg-opacity-20 hover:bg-gray-600 transition-colors relative hover-scale">
                        <i class="fas fa-bell"></i>
                        <span id="notificationBadge" class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500 animate-pulse hidden"></span>
                    </button>
                    <button id="userMenuBtn" class="p-2 rounded-full hover:bg-opacity-20 hover:bg-gray-600 transition-colors hover-scale">
                        <img src="<%= user ? user.picture : 'https://cdn-icons-png.flaticon.com/512/149/149071.png' %>" alt="User" class="user-profile rounded-full">
                    </button>
                    <button id="darkModeToggle" class="p-2 rounded-full hover:bg-opacity-20 hover:bg-gray-600 transition-colors hover-rotate">
                        <i class="fas fa-sun"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">            
            <div class="animate-slideIn box rounded-lg shadow-md p-4 transition-all duration-300 hover-scale">
                <h2 class="text-lg sm:text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-tasks mr-2 text-blue-500"></i>
                    Task Overview
                </h2>
                <div class="space-y-4">
                    <% ['todo', 'pending', 'done'].forEach(function(status) { %>
                        <div>
                            <div class="flex items-center justify-between">
                                <span class="capitalize"><%= status %></span>
                                <span id="totalCount-<%= status %>" class="font-bold <%= status === 'todo' ? 'text-blue-500' : status === 'pending' ? 'text-yellow-500' : 'text-green-500' %>">
                                    <%= tasks[status].length %>
                                </span>
                            </div>
                            <div class="bg-gray-700 rounded-full h-2">
                                <div id="<%= status %>Progress" class="<%= status === 'todo' ? 'bg-blue-500' : status === 'pending' ? 'bg-yellow-500' : 'bg-green-500' %> rounded-full h-2 transition-all duration-1000 ease-in-out" style="width: 40%"></div>
                            </div>
                        </div>
                    <% }); %>
                </div>
            </div>

            <div class="animate-slideIn box rounded-lg shadow-md p-4 transition-all duration-300 hover-scale">
                <h2 class="text-lg sm:text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-chart-bar mr-2 text-purple-500"></i>
                    Performance Metrics
                </h2>
                <div class="space-y-4">
                    <div class="flex flex-wrap gap-2">
                        <button class="px-3 py-1 sm:px-4 sm:py-2 bg-gray-700 rounded-md hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500">Daily</button>
                        <button class="px-3 py-1 sm:px-4 sm:py-2 bg-gray-700 rounded-md hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500">Weekly</button>
                        <button class="px-3 py-1 sm:px-4 sm:py-2 bg-gray-700 rounded-md hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500">Monthly</button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-chart-line text-green-500"></i>
                        <span>Daily performance up by 12%</span>
                    </div>
                    <div id="performanceChart" class="h-40 bg-gray-700 rounded-lg"></div>
                </div>
            </div>

            <div class="animate-slideIn box rounded-lg shadow-md p-4 transition-all duration-300 hover-scale">
                <h2 class="text-lg sm:text-xl font-semibold mb-4 flex items-center">
                    <i class="fas fa-bolt mr-2 text-yellow-500"></i>
                    Quick Actions
                </h2>
                <div class="grid grid-cols-2 gap-2">
                    <button class="px-2 py-1 sm:px-4 sm:py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-500 hover-scale">
                        <i class="fas fa-file-alt mr-1 sm:mr-2"></i>
                        <span class="text-xs sm:text-sm">Create Report</span>
                    </button>
                    <button class="px-2 py-1 sm:px-4 sm:py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-green-500 hover-scale">
                        <i class="fas fa-calendar-alt mr-1 sm:mr-2"></i>
                        <span class="text-xs sm:text-sm">Schedule Meeting</span>
                    </button>
                    <button class="px-2 py-1 sm:px-4 sm:py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition-colors flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-yellow-500 hover-scale">
                        <i class="fas fa-comment-alt mr-1 sm:mr-2"></i>
                        <span class="text-xs sm:text-sm">Send Feedback</span>
                    </button>
                    <button class="px-2 py-1 sm:px-4 sm:py-2 bg-purple-500 text-white rounded-md hover:bg-purple-600 transition-colors flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-purple-500 hover-scale">
                        <i class="fas fa-user-plus mr-1 sm:mr-2"></i>
                        <span class="text-xs sm:text-sm">Add Team Member</span>
                    </button>
                </div>
            </div>
          
            <div id="todoColumn" class="box p-4 rounded-lg">
                <h3 class="text-lg font-semibold mb-3">
                    <i class="fas fa-tasks mr-2"></i>To Do
                </h3>
                <% tasks.todo.forEach(task => { %>
                <div class="task_div flex justify-between box p-3 mb-3 rounded-lg shadow-md items-center hover-scale">
                    <p class="text-sm sm:text-base font-medium">
                        <% if (task.priority === 'high') { %>
                            <i class="fas fa-exclamation-circle text-red-600 mr-2"></i>
                        <% } else if (task.priority === 'medium') { %>
                            <i class="fas fa-exclamation-circle text-yellow-500 mr-2"></i>
                        <% } else { %>
                            <i class="fas fa-exclamation-circle text-green-500 mr-2"></i>
                        <% } %>
                        <p class="todo_task_name"><%= task.task_name %></p>
                        <br> <span class="due_date_todo text-xs sm:text-sm">Due Date: <%= task.due_date %></span>
                    </p>
                    <div class="flex space-x-2 text-lg">
                        <button class="status-btn pending text-blue-400 hover:text-blue-600 transition duration-150 pad-2 mr-2">
                            <i class="pending fas fa-hourglass-half"></i>
                        </button>
                        <button class="status-btn done text-green-400 hover:text-green-600 transition duration-150">
                            <i class="done fas fa-check-circle"></i>
                        </button>
                    </div>
                </div>
                <% }) %>
                <button id="add-task-btn" class="add-task-btn bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-150 hover-scale">
                    <i class="fas fa-plus mr-2"></i>Add Task
                </button>
            </div>

            <div id="inProgressColumn" class="box p-4 rounded-lg">
                <h3 class="text-lg font-semibold mb-3">
                    <i class="fas fa-spinner mr-2"></i>In Progress
                </h3>
                <% tasks.pending.forEach(task => { %>
                <div class="task_div flex justify-between box p-3 mb-3 rounded-lg shadow-md items-center hover-scale">
                    <p class="text-sm sm:text-base font-medium"><%= task.task_name %></p>
                    <button class="status-btn done text-green-400 hover:text-green-600 transition duration-150">
                        <i class="fas fa-check-circle"></i>
                    </button>
                </div>
                <% }) %>
            </div>

            <div id="doneColumn" class="box p-4 rounded-lg">
                <h3 class="text-lg font-semibold mb-3">
                    <i class="fas fa-check-double mr-2"></i>Done
                </h3>
                <p class="text-xs sm:text-sm opacity-70">Note: Tasks will be deleted in 1hr automatically</p>
                <% tasks.done.forEach(task => { %>
                <div class="done_div box flex justify-between p-3 mb-3 rounded-lg shadow-md hover-scale">
                    <p class="text-sm sm:text-base font-medium"><%= task.task_name %></p>
                    <button class="delete-task-btn text-red-400 hover:text-red-600 transition duration-150" data-task-id="<%= task.id %>">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                    
                </div>
                <% }) %>
            </div>
        </div>
    </div>

    <dialog id="taskDialog" class="box p-6 rounded-lg shadow-lg">
        <form id="taskForm" method="dialog">
            <h2 class="text-xl sm:text-2xl font-semibold  mb-4">Add New Task</h2>
            <div class="mb-4">
                <label for="taskName" class="block text-sm font-medium">Task Name</label>
                <input type="text" id="taskName" required class="mt-1 p-2 block w-full border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700">
            </div>
            <div class="mb-4">
                <label for="due-date" class="block text-sm font-medium">Due Date</label>
                <input type="date" id="due-date" required class="mt-1 p-2 block w-full border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700">
            </div>
            <div class="mb-4">
                <label for="priority" class="block text-sm font-medium">Priority</label>
                <select id="priority" class="mt-1 p-2 block w-full border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600 bg-gray-700">
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                </select>
            </div>
            <div class="flex justify-end">
                <button type="button" id="cancelBtn" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition duration-150">
                    Cancel
                </button>
                <button type="submit" id="submitTask" class="ml-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-150">
                    Add Task
                </button>
            </div>
        </form>
    </dialog>

    <button id="notificationBtn" class="p-2 rounded-full hover:bg-opacity-20 hover:bg-gray-600 transition-colors relative hover-scale">
        <i class="fas fa-bell"></i>
        <span id="notificationBadge" class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500 animate-pulse hidden"></span>
    </button>
    
    <div id="notificationDiv" class="hidden fixed top-4 right-4 w-full max-w-sm box p-4 rounded-lg shadow-lg animate-fadeIn">
        <h2 class="text-xl sm:text-2xl font-semibold text-purple-400 mb-2">Notifications</h2>
        <p id="notificationText" class="notification-text text-sm sm:text-lg">No new notifications.</p>
        <button id="notification-close-btn" class="mt-4 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">
            Close
        </button>
    </div>
    

    <div id="funFactSidebar" class="fun-facts fixed bottom-4 right-4 w-full max-w-sm box p-4 rounded-lg shadow-lg animate-slideIn">
        <h2 class="text-xl sm:text-2xl font-semibold text-purple-400 mb-2">Did you know?</h2>
        <p id="funFactText" class="text-sm sm:text-lg"><%= funfact %></p>
        <button id="funfact-close-btn" class="mt-4 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors">
            Close
        </button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            const darkModeToggle = document.getElementById('darkModeToggle');
            const body = document.body;
            const icon = darkModeToggle.querySelector('i');

           
            const updateColors = (isLightMode) => {
                document.documentElement.style.setProperty('--bg-dark', isLightMode ? '#ffffff' : '#121212');
                document.documentElement.style.setProperty('--bg-light', isLightMode ? '#f0f0f0' : '#1e1e1e');
                document.documentElement.style.setProperty('--text-dark', isLightMode ? '#000000' : '#ffffff');
                document.documentElement.style.setProperty('--text-light', isLightMode ? '#333333' : '#e0e0e0');
                document.documentElement.style.setProperty('--box-dark', isLightMode ? '#f0f0f0' : '#1e1e1e');
                document.documentElement.style.setProperty('--box-light', isLightMode ? '#ffffff' : '#2a2a2a');
                document.documentElement.style.setProperty('--box-hover-dark', isLightMode ? '#e0e0e0' : '#2a2a2a');
                document.documentElement.style.setProperty('--box-hover-light', isLightMode ? '#f5f5f5' : '#333333');
            };

            darkModeToggle.addEventListener('click', () => {
                body.classList.toggle('light-mode');
                icon.classList.toggle('fa-moon');
                icon.classList.toggle('fa-sun');
                updateColors(body.classList.contains('light-mode'));
            });

            // // Initialize task progress bars
            // ['todo', 'pending', 'done'].forEach(status => {
            //     const count = document.getElementById(`${status}Count`).textContent;
            //     const progress = document.getElementById(`${status}Progress`);
            //     const totalTasks = <%= tasks.todo.length + tasks.pending.length + tasks.done.length %>;
            //     const percentage = (count / totalTasks) * 100;
            //     progress.style.width = `${percentage}%`;
            // });
           
        });
    </script>
</body>
</html>